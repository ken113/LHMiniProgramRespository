{"version":3,"sources":["webpack:///E:/LHMiniProgramRespository/components/form/travelDate.vue?d78a","webpack:///E:/LHMiniProgramRespository/components/form/travelDate.vue?ad94","webpack:///E:/LHMiniProgramRespository/components/form/travelDate.vue?0f05","webpack:///E:/LHMiniProgramRespository/components/form/travelDate.vue?5470","uni-app:///components/form/travelDate.vue"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;;;AAGzD;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAomB,CAAgB,8nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuBxnB,oF;;AAEA;AACA;AACA,0BADA,EADA;;AAIA;AACA;AACA,kBADA;AAEA;AACA;AACA,OAJA,EADA;;AAOA;AACA,kBADA;AAEA;AACA;AACA,OAJA,EAPA,EAJA;;;AAkBA,MAlBA,kBAkBA;AACA;;AAEA;AACA,cADA;AAEA,eAFA;AAGA,sBAHA;AAIA,sBAJA;AAKA,mBALA;AAMA,iBANA;AAOA;AACA,wBADA;AAEA,+BAFA;AAGA,6BAHA,EAPA;;AAYA,uBAZA;;AAcA,GAnCA;AAoCA,SApCA,qBAoCA;;;AAGA;AACA;AACA;AACA,0BADA;AAEA,oBAFA;AAGA,yBAHA;AAIA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,KArBA,MAqBA;;;;AAIA,8BAJA,CAEA,WAFA,yBAEA,WAFA,CAGA,UAHA,yBAGA,UAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBADA;AAEA,qBAFA;AAGA,4BAHA;AAIA,kBAJA;AAKA,uBALA;;AAOA,KA7BA;;AA+BA,4BAzFA;;;;AA6FA,4BA7FA,CA2FA,aA3FA,0BA2FA,aA3FA,CA4FA,SA5FA,0BA4FA,SA5FA;;AA+FA;AACA;AACA;AACA;AACA,KAJA,MAIA;AACA;AACA,KAFA,MAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAhJA;AAiJA;AACA,cADA,sBACA,UADA,EACA;AACA;AACA;AACA;AACA;;;;;AAKA,wBALA,CAEA,YAFA,qBAEA,YAFA,CAGA,SAHA,qBAGA,SAHA,CAIA,OAJA,qBAIA,OAJA;;AAOA;;AAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;;AAEA;;AAEA,OAlBA,MAkBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAhCA;AAiCA,eAjCA,uBAiCA,KAjCA,EAiCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aADA,EACA;AACA;AACA,oDADA;AAEA,wBAFA;;AAIA;AACA;AACA;AACA,KAnDA;AAoDA,mBApDA,6BAoDA;AACA;AACA,sCADA;AAEA,qBAFA;AAGA;AACA,2DADA,EAHA;;AAMA,UANA,CAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAbA;AAcA,KAnEA;AAoEA,uBApEA,+BAoEA,OApEA,EAoEA;AACA;AACA,uCADA;AAEA,wBAFA;;AAIA;AACA;AACA,4CADA,EACA;AACA,wEAFA;AAGA,oEAHA;AAIA,sEAJA;AAKA,kEALA;AAMA,gDANA;AAOA,gCAPA;AAQA,yDARA;;AAUA;;AAEA;;AAEA;AACA;AACA,cADA,GACA,IADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,WARA,MAQA;AACA;AACA,gBADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,WARA,MAQA;AACA;AACA,gBADA,EACA;AACA;AACA;;AAEA;AACA;AACA,iBAFA,MAEA;AACA;AACA;AACA;AACA;AACA,WAbA,MAaA;AACA;AACA,gBADA,EACA;AACA;AACA;AACA,eADA,EACA;AACA;AACA;AACA;AACA;AACA,SA3CA,MA2CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WARA,MAQA;AACA;AACA,gBADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA,WARA,MAQA;AACA;AACA,gBADA,EACA;AACA;AACA;;AAEA;AACA;AACA,iBAFA,MAEA;AACA;AACA;AACA;AACA;AACA,WAbA,MAaA;AACA;AACA,gBADA,EACA;AACA;AACA;AACA,eADA,EACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAFA;;AAIA;AACA;AACA;AACA;;AAEA;AACA,6DADA;AAEA,yDAFA;AAGA,qCAHA;;;AAMA,OAzHA;AA0HA,KAnMA;AAoMA,cApMA,wBAoMA;AACA;AACA;AACA;AACA,KAxMA;AAyMA,gBAzMA,0BAyMA;;;;;AAKA,8BALA,CAEA,aAFA,0BAEA,aAFA,CAGA,SAHA,0BAGA,SAHA,CAIA,QAJA,0BAIA,QAJA;;AAOA;AACA;AACA;AACA;AACA;AACA,SAJA;AAKA,OAbA;;;AAgBA,eAhBA,KAgBA,SAhBA,iBAgBA,OAhBA;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sDADA,EACA;AACA;AACA,oBADA,GACA,UADA,GACA,GADA;AAEA;AACA;AACA;AACA;AACA,sDADA,EACA;AACA;AACA,oBADA,GACA,QADA,GACA,GADA;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,KArQA;AAsQA,cAtQA,sBAsQA,KAtQA,EAsQA,CAtQA,EAsQA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAlRA;AAmRA,eAnRA,uBAmRA,WAnRA,EAmRA;;AAEA;AACA,wBAHA;;;;AAOA,8BAPA,CAKA,SALA,0BAKA,SALA,CAMA,aANA,0BAMA,aANA;AAQA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,KApSA;AAqSA,kBArSA,0BAqSA,IArSA,EAqSA;AACA;AACA;AACA;AACA;AACA,wBADA,CACA,SADA,CACA,CADA,EACA,EADA,KACA,mCADA,EACA;AACA;AACA,qCADA;AAEA,sBAFA;;AAIA;AACA;AACA;AACA;AACA;AACA,wCADA;AAEA,oBAFA;;AAIA;AACA;AACA;AACA;;AAEA,aAFA;;;AAKA,YALA,CAEA,KAFA,CAGA,SAHA,GAKA,IALA,CAGA,SAHA,CAIA,IAJA,GAKA,IALA,CAIA,IAJA;AAMA;AACA;AACA;AACA,sBADA;AAEA,qBAFA;AAGA,4BAHA;AAIA,8BAJA;;AAMA;AACA;AACA;AACA;AACA,OAlBA;AAmBA;AACA,iCADA;AAEA,iCAFA;;AAIA;AACA;AACA,oCADA;AAEA,wDAFA;AAGA,0BAHA;;AAKA,KAvVA,EAjJA,E","file":"components/form/travelDate.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./travelDate.vue?vue&type=template&id=7ec36bb0&\"\nvar renderjs\nimport script from \"./travelDate.vue?vue&type=script&lang=js&\"\nexport * from \"./travelDate.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/form/travelDate.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./travelDate.vue?vue&type=template&id=7ec36bb0&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./travelDate.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./travelDate.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"lhform form-travel-date\">\r\n\r\n\t\t<view v-for=\"(element,index) in initFormData.elements\" :key=\"index\"\r\n\t\t\t:class=\"form[index].errorText ? 'error-item':'' \" v-if=\"form[index].show\">\r\n\t\t\t<view class=\"uib-item\">\r\n\t\t\t\t<view class=\"item-left\">{{ element.name }}</view>\r\n\t\t\t\t<view class=\"item-right\" @tap=\"selectDate(index)\">\r\n\t\t\t\t\t<input class=\"ipt\" disabled :placeholder=\"element.tips || 'YYYY-MM-DD'\" v-model=\"form[index].value\"\r\n\t\t\t\t\t\t@blur=\"changeDate(index,$event)\" />\r\n\t\t\t\t\t<text class=\"iconright iconfont\">&#xe602;</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"error-text\">{{form[index].errorText}}</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<LHCalendar ref=\"lhcalendar\" :value=\"calendarValue\" :startDate=\"startDate\" :endDate=\"endDate\"\r\n\t\t\t:disabledList=\"disabledList\" type=\"date\" @confirm=\"confirmDate\" @cancel=\"cancelDate\"></LHCalendar>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport util from '@/common/util.js';\r\n\timport LHCalendar from '../LHCalendar.vue'\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tLHCalendar\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\torderDetail: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: function() {\r\n\t\t\t\t\treturn {};\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinitFormData: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: function() {\r\n\t\t\t\t\treturn {};\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\tconsole.log(this.initFormData);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tform: [],\r\n\t\t\t\trules: [],\r\n\t\t\t\tselectType: null,\r\n\t\t\t\tdisabledList: [],\r\n\t\t\t\tstartDate: '',\r\n\t\t\t\tendDate: '',\r\n\t\t\t\tdateOptions: {\r\n\t\t\t\t\tdisabledList: [],\r\n\t\t\t\t\tstartDate: '1900-01-01',\r\n\t\t\t\t\tendDate: '2100-01-01',\r\n\t\t\t\t},\r\n\t\t\t\tcalendarValue: '',\r\n\t\t\t};\r\n\t\t},\r\n\t\tcreated() {\r\n\r\n\r\n\t\t\tthis.getProductRules();\r\n\t\t\tlet data = null;\r\n\t\t\tlet _ServiceDate = '',\r\n\t\t\t\t_ServiceDateError = '',\r\n\t\t\t\t_BackupDate = '',\r\n\t\t\t\t_BackupDateError = '';\r\n\t\t\tif (this.orderDetail.Product.ElementsValue && this.orderDetail.Product.ElementsValue !== '{}') {\r\n\r\n\t\t\t\tlet ElementsValue = JSON.parse(this.orderDetail.Product.ElementsValue);\r\n\t\t\t\tdata = ElementsValue[this.initFormData.componentItem];\r\n\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\tif (data.formData && data.formData.ServiceDate) {\r\n\t\t\t\t\t\t_ServiceDate = data.formData.ServiceDate.value;\r\n\t\t\t\t\t\tif (data.formData.ServiceDate.tipsClass.indexOf('tips') > -1) {\r\n\t\t\t\t\t\t\t_ServiceDateError = data.formData.ServiceDate.formTips;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (data.formData && data.formData.BackDate) {\r\n\t\t\t\t\t\t_BackupDate = data.formData.BackDate.value;\r\n\t\t\t\t\t\tif (data.formData.BackDate.tipsClass.indexOf('tips') > -1) {\r\n\t\t\t\t\t\t\t_BackupDateError = data.formData.BackDate.formTips;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t} else {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tServiceDate,\r\n\t\t\t\t\tBackupDate\r\n\t\t\t\t} = this.orderDetail.Product;\r\n\t\t\t\tif (ServiceDate) {\r\n\t\t\t\t\t_ServiceDate = ServiceDate.substring(0, 10);\r\n\t\t\t\t}\r\n\t\t\t\tif (BackupDate) {\r\n\t\t\t\t\t_BackupDate = BackupDate.substring(0, 10);\r\n\t\t\t\t}\r\n\t\t\t\tif (_ServiceDate == '0001-01-01' || _ServiceDate == '1900-01-01') {\r\n\t\t\t\t\t_ServiceDate = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (_ServiceDate.substring(0, 4) * 1 < 1901) {\r\n\t\t\t\t\t_ServiceDate = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (_BackupDate == '0001-01-01' || _BackupDate == '1900-01-01') {\r\n\t\t\t\t\t_BackupDate = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (_BackupDate.substring(0, 4) * 1 < 1901) {\r\n\t\t\t\t\t_BackupDate = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (this.orderDetail.PlatformTravelDate) {\r\n\t\t\t\t\t_ServiceDate = this.orderDetail.PlatformTravelDate.substring(0, 10);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.initFormData.elements.forEach((item, index) => {\r\n\t\t\t\tlet _value = '',\r\n\t\t\t\t\terrorText = '';\r\n\r\n\t\t\t\tif (index === 0) {\r\n\t\t\t\t\t_value = _ServiceDate;\r\n\t\t\t\t\tif (!_ServiceDate) {\r\n\t\t\t\t\t\terrorText = '请选择出行日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_ServiceDateError) {\r\n\t\t\t\t\t\terrorText = _ServiceDateError;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (index === 1) {\r\n\t\t\t\t\t_value = _BackupDate;\r\n\t\t\t\t\tif (!_BackupDate) {\r\n\t\t\t\t\t\terrorText = '请选择返回日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (_BackupDateError) {\r\n\t\t\t\t\t\terrorText = _BackupDateError;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.form.push({\r\n\t\t\t\t\tcode: item.code,\r\n\t\t\t\t\tvalue: _value,\r\n\t\t\t\t\terrorText,\r\n\t\t\t\t\tshow: true,\r\n\t\t\t\t\ttips: item.tips,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tlet showBackDate = true;\r\n\t\t\tconst {\r\n\t\t\t\tServiceTypeID,\r\n\t\t\t\tFixedDays\r\n\t\t\t} = this.orderDetail.Product;\r\n\r\n\t\t\tif (ServiceTypeID == 2) { //行程类\r\n\t\t\t\tif (FixedDays == 1) { //行程天数等于1，不需要显示\r\n\t\t\t\t\tshowBackDate = false;\r\n\t\t\t\t}\r\n\t\t\t} else if (ServiceTypeID == 1) { //交通类\r\n\t\t\t\tshowBackDate = false;\r\n\t\t\t} else if (ServiceTypeID == 3) { //门票类\r\n\t\t\t\tshowBackDate = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (!showBackDate) {\r\n\t\t\t\tthis.form[1].show = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tselectDate(selectType) {\r\n\t\t\t\tif (this.orderDetail.CustomerState !== 0 && this.orderDetail.CustomerState !== 20) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (selectType === 0) {\r\n\t\t\t\t\tconst {\r\n\t\t\t\t\t\tdisabledList,\r\n\t\t\t\t\t\tstartDate,\r\n\t\t\t\t\t\tendDate\r\n\t\t\t\t\t} = this.dateOptions;\r\n\r\n\t\t\t\t\tthis.disabledList = disabledList;\r\n\r\n\t\t\t\t\tif (startDate != '1900-01-01') {\r\n\t\t\t\t\t\tthis.startDate = startDate;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.startDate = util.dateFormat(new Date(), 'd')\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.endDate = endDate;\r\n\r\n\t\t\t\t\tthis.calendarValue = this.form[0].value;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.disabledList = [];\r\n\t\t\t\t\tthis.startDate = '';\r\n\t\t\t\t\tthis.endDate = '';\r\n\t\t\t\t\tthis.calendarValue = this.form[1].value;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.$refs.lhcalendar.showCalendar();\r\n\t\t\t\tthis.selectType = selectType;\r\n\t\t\t},\r\n\t\t\tconfirmDate(value) {\r\n\t\t\t\tthis.form[this.selectType].value = value;\r\n\t\t\t\tthis.form[this.selectType].errorText = '';\r\n\t\t\t\tif (this.selectType === 0) {\r\n\r\n\t\t\t\t\t//自动填写返回日期\r\n\t\t\t\t\tif (this.form[1].show) {\r\n\t\t\t\t\t\tthis.setBackDate(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.orderDetail.PlatformTravelDate && this.orderDetail.PlatformTravelDate.substring(0, 10) !=\r\n\t\t\t\t\t\tvalue) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '您修改的出行日期和拍下商品填写的出行日期不一致，请您做好核对！',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.validateDate();\r\n\t\t\t},\r\n\t\t\tgetProductRules() {\r\n\t\t\t\tthis.$sendRequest({\r\n\t\t\t\t\turl: \"/WxOpen/GetProductRules\",\r\n\t\t\t\t\tmethod: \"GET\",\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tserviceItemID: this.orderDetail.Product.ProductID\r\n\t\t\t\t\t},\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.Code === 200) {\r\n\t\t\t\t\t\tthis.getDisabledDateList(res.data);\r\n\t\t\t\t\t\tif (res.data.length) {\r\n\t\t\t\t\t\t\tthis.validateDate();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetDisabledDateList(ruleArr) {\r\n\t\t\t\tlet startDate = +new Date('2010/01/01'),\r\n\t\t\t\t\tendDate = +new Date('2100/01/01'),\r\n\t\t\t\t\tdatesDisabled = [];\r\n\r\n\t\t\t\truleArr.forEach((item) => {\r\n\t\t\t\t\tlet RuleUseTypeValue = item.RuleUseTypeValue, //0:只允许，1：禁止\r\n\t\t\t\t\t\tSelectRuleType = item.SelectRuleType, //0:日期范围，1：星期选择，2：单双选择，3：固定日期\r\n\t\t\t\t\t\tRangeStart = item.RangeStart.substring(0, 10).replace(/-/g, \"/\"),\r\n\t\t\t\t\t\tRangeEnd = item.RangeEnd.substring(0, 10).replace(/-/g, \"/\"),\r\n\t\t\t\t\t\tStartTime = item.StartTime.substring(0, 10).replace(/-/g, \"/\"),\r\n\t\t\t\t\t\tEndTime = item.EndTime.substring(0, 10).replace(/-/g, \"/\"),\r\n\t\t\t\t\t\tWeek = item.Week && item.Week.split('|'),\r\n\t\t\t\t\t\tIsDouble = item.IsDouble,\r\n\t\t\t\t\t\tUseDate = item.UseDate && item.UseDate.split('|');\r\n\r\n\t\t\t\t\tif (RuleUseTypeValue) {\r\n\r\n\t\t\t\t\t\t//范围内，其他时间可以选择\r\n\r\n\t\t\t\t\t\tif (SelectRuleType == 0) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(RangeStart)); i <= (+new Date(RangeEnd)); i = i + 24 * 60 *\r\n\t\t\t\t\t\t\t\t60 * 1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1) {\r\n\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 1) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(StartTime)); i <= (+new Date(EndTime)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1 && Week.indexOf(tmp.getDay() + '') > -1) {\r\n\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 2) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(StartTime)); i <= (+new Date(EndTime)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (IsDouble && tmp.getDate() % 2 == 0) { //双号\r\n\t\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t\t} else if (!IsDouble && tmp.getDate() % 2 == 1) {\r\n\t\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 3) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(StartTime)); i <= (+new Date(EndTime)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1 && UseDate.indexOf(tmp.getDate() + '') > -\r\n\t\t\t\t\t\t\t\t\t1) {\r\n\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else { //只允许，日期排除放入datesDisabled\r\n\r\n\t\t\t\t\t\t//获取最近的开始时间\r\n\t\t\t\t\t\tif (+new Date(StartTime) > startDate) {\r\n\t\t\t\t\t\t\tstartDate = +new Date(StartTime);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//获取最近的结束时间\r\n\t\t\t\t\t\tif (+new Date(EndTime) < endDate) {\r\n\t\t\t\t\t\t\tendDate = +new Date(EndTime);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (SelectRuleType == 0) {\r\n\r\n\t\t\t\t\t\t\tif (+new Date(RangeStart) > startDate) {\r\n\t\t\t\t\t\t\t\tstartDate = +new Date(RangeStart);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (+new Date(RangeEnd) < endDate) {\r\n\t\t\t\t\t\t\t\tendDate = +new Date(RangeEnd);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 1) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(startDate)); i <= (+new Date(endDate)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1 && Week.indexOf(tmp.getDay() + '') === -1) {\r\n\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 2) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(startDate)); i <= (+new Date(endDate)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (IsDouble && tmp.getDate() % 2 == 1) { //双号\r\n\t\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t\t} else if (!IsDouble && tmp.getDate() % 2 == 0) {\r\n\t\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (SelectRuleType == 3) {\r\n\t\t\t\t\t\t\tfor (var i = (+new Date(startDate)); i <= (+new Date(endDate)); i = i + 24 * 60 * 60 *\r\n\t\t\t\t\t\t\t\t1000) {\r\n\t\t\t\t\t\t\t\tvar tmp = new Date(i);\r\n\t\t\t\t\t\t\t\tif (datesDisabled.indexOf(tmp) === -1 && UseDate.indexOf(tmp.getDate() + '') === -\r\n\t\t\t\t\t\t\t\t\t1) {\r\n\t\t\t\t\t\t\t\t\tdatesDisabled.push(tmp);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdatesDisabled.forEach((item, index) => {\r\n\t\t\t\t\t\tdatesDisabled[index] = util.dateFormat(item, 'd');\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tlet today = util.dateFormat(new Date(), 'd')\r\n\t\t\t\t\tif (startDate < +new Date(today)) {\r\n\t\t\t\t\t\tstartDate = +new Date(today);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.dateOptions = {\r\n\t\t\t\t\t\tstartDate: util.dateFormat(startDate, 'd'),\r\n\t\t\t\t\t\tendDate: util.dateFormat(endDate, 'd'),\r\n\t\t\t\t\t\tdisabledList: datesDisabled\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcancelDate() {\r\n\t\t\t\tif (!this.form[this.selectType].value) {\r\n\t\t\t\t\tthis.form[this.selectType].errorText = '请选择日期';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tvalidateDate() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tServiceTypeID,\r\n\t\t\t\t\tFixedDays,\r\n\t\t\t\t\tRightNum\r\n\t\t\t\t} = this.orderDetail.Product;\r\n\r\n\t\t\t\tif (this.initFormData.mandatory === '1') {\r\n\t\t\t\t\tthis.form.forEach((item, index) => {\r\n\t\t\t\t\t\tif (!item.value && item.show) {\r\n\t\t\t\t\t\t\tthis.form[index].errorText = '请选择正确的日期';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tconst [startDate, endDate] = this.form;\r\n\t\t\t\tconst _FixedDays = FixedDays - 1;\r\n\t\t\t\tif (this.form.length === 2) {\r\n\t\t\t\t\tif (startDate.value && endDate.value) {\r\n\t\t\t\t\t\tlet tips = '';\r\n\t\t\t\t\t\tif (+new Date(startDate.value.replace(/-/g, \"/\")) > +new Date(endDate.value.replace(/-/g, \"/\"))) {\r\n\t\t\t\t\t\t\ttips = this.initFormData.elements[1].name + '不能小于' + this.initFormData.elements[0].name;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ServiceTypeID == 2 && _FixedDays > 0) {\r\n\r\n\t\t\t\t\t\t\tif (+new Date(startDate.value.replace(/-/g, \"/\")) + _FixedDays * 24 * 60 * 60 * 1000 != +\r\n\t\t\t\t\t\t\t\tnew Date(endDate.value.replace(/-/g, \"/\"))) {\r\n\t\t\t\t\t\t\t\ttips = this.initFormData.elements[0].name + '和' + this.initFormData.elements[1].name +\r\n\t\t\t\t\t\t\t\t\t'应该相差' + _FixedDays + '天';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (ServiceTypeID == 4) {\r\n\t\t\t\t\t\t\tif (+new Date(startDate.value.replace(/-/g, \"/\")) + RightNum * 24 * 60 * 60 * 1000 != +\r\n\t\t\t\t\t\t\t\tnew Date(endDate.value.replace(/-/g, \"/\"))) {\r\n\t\t\t\t\t\t\t\ttips = this.initFormData.elements[0].name + '和' + this.initFormData.elements[1].name +\r\n\t\t\t\t\t\t\t\t\t'应该相差' + RightNum + '晚';\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.form[1].errorText = tips;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (startDate.value && this.dateOptions) {\r\n\r\n\t\t\t\t\tif (+new Date(startDate.value.replace(/-/g, \"/\")) < +new Date(this.dateOptions.startDate)) {\r\n\t\t\t\t\t\tthis.form[0].value = '';\r\n\t\t\t\t\t\tthis.form[0].errorText = '请选择正确的日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (+new Date(startDate.value.replace(/-/g, \"/\")) > +new Date(this.dateOptions.endDate)) {\r\n\t\t\t\t\t\tthis.form[0].value = '';\r\n\t\t\t\t\t\tthis.form[0].errorText = '请选择正确的日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.dateOptions.disabledList.indexOf(startDate.value) > -1) {\r\n\t\t\t\t\t\tthis.form[0].value = '';\r\n\t\t\t\t\t\tthis.form[0].errorText = '请选择正确的日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tchangeDate(index, e) {\r\n\t\t\t\tconst value = e ? e.detail.value.trim() : this.form[index].value;\r\n\t\t\t\tlet tips = '';\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\ttips = '请选择正确的日期';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!util.isDate(value)) {\r\n\t\t\t\t\t\ttips = '请选择正确的日期';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.form[index].errorText = tips;\r\n\r\n\t\t\t},\r\n\t\t\tsetBackDate(serviceDate) {\r\n\r\n\t\t\t\t//默认返回日期，出行天数等于0,1，等于出行时间，否则等于出行时间 + 天数 - 1;\r\n\t\t\t\tlet backDate = '';\r\n\t\t\t\tconst {\r\n\t\t\t\t\tFixedDays,\r\n\t\t\t\t\tServiceTypeID\r\n\t\t\t\t} = this.orderDetail.Product;\r\n\t\t\t\tif (ServiceTypeID === 2) {\r\n\t\t\t\t\tif (FixedDays < 2) {\r\n\t\t\t\t\t\tbackDate = serviceDate;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbackDate = util.dateFormat(+new Date(serviceDate) + (FixedDays - 1) * 24 * 60 * 60 * 1000, 'd');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.form[1].value = backDate;\r\n\t\t\t\tthis.form[1].errorText = '';\r\n\t\t\t},\r\n\t\t\tgetFiledsValue(type) {\r\n\t\t\t\tif (type === 1) {\r\n\t\t\t\t\tthis.validateDate();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.form[0].value && this.orderDetail.PlatformTravelDate && this.orderDetail\r\n\t\t\t\t\t.PlatformTravelDate.substring(0, 10) != this.form[0].value.substring(0, 10)) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '拍下时日期与提交的不同，请仔细核对！',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tconst ElementsValue = {};\r\n\t\t\t\tconst ServiceItemTemplteValue = {};\r\n\t\t\t\tlet hasError = [];\r\n\t\t\t\tElementsValue[this.initFormData.componentItem] = {\r\n\t\t\t\t\tcomponentInfo: this.initFormData,\r\n\t\t\t\t\tformData: {}\r\n\t\t\t\t};\r\n\t\t\t\tif (!this.form[1].show) {\r\n\t\t\t\t\tthis.form[1].errorText = '';\r\n\t\t\t\t}\r\n\t\t\t\tthis.form.forEach(item => {\r\n\t\t\t\t\tconst {\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\terrorText,\r\n\t\t\t\t\t\ttips\r\n\t\t\t\t\t} = item;\r\n\t\t\t\t\tlet tipsClass = errorText ? 'help-inline tips' : 'help-inline';\r\n\t\t\t\t\tlet formTips = errorText ? errorText : tips;\r\n\t\t\t\t\tElementsValue[this.initFormData.componentItem].formData[item.code] = {\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\ttext: value,\r\n\t\t\t\t\t\tformTips,\r\n\t\t\t\t\t\ttipsClass\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (errorText) {\r\n\t\t\t\t\t\thasError.push(errorText);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tServiceItemTemplteValue[item.code] = value;\r\n\t\t\t\t});\r\n\t\t\t\tconst date = {\r\n\t\t\t\t\tdate1: this.form[0].value,\r\n\t\t\t\t\tdate2: this.form[1].value,\r\n\t\t\t\t};\r\n\t\t\t\tthis.$emit('changeDate', date)\r\n\t\t\t\treturn {\r\n\t\t\t\t\tElementsValue,\r\n\t\t\t\t\tServiceItemTemplteValue,\r\n\t\t\t\t\thasError\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\n"],"sourceRoot":""}